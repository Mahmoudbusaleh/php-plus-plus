<?php
/**
 * ملف الإقلاع العالمي (Global Bootstrap) - محرك PHP++
 * * هذا الملف هو "نقطة التجمع" لكل مكونات النظام.
 * وظيفته هي تحضير البيئة، استدعاء الكلاسات، والتأكد من أن المحرك 
 * جاهز لاستقبال طلبات المستخدم في أجزاء من الثانية.
 */

// ١. نظام التحميل الذكي (Core Loading):
// نقوم بحصر جميع الملفات الحيوية التي تشكل "عقل" المشروع.
$coreFiles = [
    'Compiler.php', // المسؤول عن بناء البيئة وترجمة C++
    'Router.php',   // المحرك المسؤول عن توجيه المسارات
    'Request.php',  // حارس الأمان لتنظيف البيانات
    'Response.php', // المنسق النهائي للردود (JSON/HTML)
    'View.php',     // محرك عرض الواجهات
    'Helpers.php'   // الدوال المختصرة لتسهيل حياة المبرمج
];

// الدوران على الملفات واستدعاؤها لمرة واحدة فقط لضمان عدم تكرار التعريفات
foreach ($coreFiles as $file) {
    $filePath = __DIR__ . '/src/' . $file;
    if (file_exists($filePath)) {
        require_once $filePath;
    }
}

/**
 * ٢. تشغيل المترجم التلقائي (Auto-Compiler Activation):
 * هنا تحدث "الشرارة الأولى". نستدعي دالة build التي تقوم بـ:
 * - إنشاء مجلدات الكاش والواجهات تلقائياً.
 * - التأكد من وجود ملف الـ .htaccess لضبط الروابط.
 * - ترجمة كود الـ C++ وتحويله لملف .so إذا لم يكن موجوداً.
 */
\PHPPlusPlus\Compiler::build();

/**
 * ٣. نظام الأسماء المستعارة (Class Aliasing):
 * لتسهيل تجربة المطور، نقوم بعمل "اختصار" لكلاس الراوتر.
 * بدلاً من كتابة \PHPPlusPlus\Router في كل مرة، 
 * يمكن للمبرمج ببساطة استخدام حرف 'P' (اختصار لـ P++).
 */
if (!class_exists('P')) {
    class_alias('\PHPPlusPlus\Router', 'P');
}

